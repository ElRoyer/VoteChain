import{r as b}from"./cids.77d54c26.js";import{r as ee}from"./protobufjs.15525302.js";import{r as fe}from"./multiformats.98c9d81a.js";import{r as le}from"./stable.dcf995a2.js";import{r as he}from"./multicodec.9e8e4a02.js";import{s as de}from"./multihashing-async.5e067dad.js";var k={},D,_;function te(){if(_)return D;_=1;var c=ee(),o=c.Reader,u=c.Writer,n=c.util,r=c.roots.default||(c.roots.default={});return r.PBLink=function(){function i(s){if(s)for(var e=Object.keys(s),t=0;t<e.length;++t)s[e[t]]!=null&&(this[e[t]]=s[e[t]])}return i.prototype.Hash=n.newBuffer([]),i.prototype.Name="",i.prototype.Tsize=n.Long?n.Long.fromBits(0,0,!0):0,i.encode=function(e,t){return t||(t=u.create()),e.Hash!=null&&Object.hasOwnProperty.call(e,"Hash")&&t.uint32(10).bytes(e.Hash),e.Name!=null&&Object.hasOwnProperty.call(e,"Name")&&t.uint32(18).string(e.Name),e.Tsize!=null&&Object.hasOwnProperty.call(e,"Tsize")&&t.uint32(24).uint64(e.Tsize),t},i.decode=function(e,t){e instanceof o||(e=o.create(e));for(var a=t===void 0?e.len:e.pos+t,l=new r.PBLink;e.pos<a;){var f=e.uint32();switch(f>>>3){case 1:l.Hash=e.bytes();break;case 2:l.Name=e.string();break;case 3:l.Tsize=e.uint64();break;default:e.skipType(f&7);break}}return l},i.fromObject=function(e){if(e instanceof r.PBLink)return e;var t=new r.PBLink;return e.Hash!=null&&(typeof e.Hash=="string"?n.base64.decode(e.Hash,t.Hash=n.newBuffer(n.base64.length(e.Hash)),0):e.Hash.length&&(t.Hash=e.Hash)),e.Name!=null&&(t.Name=String(e.Name)),e.Tsize!=null&&(n.Long?(t.Tsize=n.Long.fromValue(e.Tsize)).unsigned=!0:typeof e.Tsize=="string"?t.Tsize=parseInt(e.Tsize,10):typeof e.Tsize=="number"?t.Tsize=e.Tsize:typeof e.Tsize=="object"&&(t.Tsize=new n.LongBits(e.Tsize.low>>>0,e.Tsize.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var a={};if(t.defaults)if(t.bytes===String?a.Hash="":(a.Hash=[],t.bytes!==Array&&(a.Hash=n.newBuffer(a.Hash))),a.Name="",n.Long){var l=new n.Long(0,0,!0);a.Tsize=t.longs===String?l.toString():t.longs===Number?l.toNumber():l}else a.Tsize=t.longs===String?"0":0;return e.Hash!=null&&e.hasOwnProperty("Hash")&&(a.Hash=t.bytes===String?n.base64.encode(e.Hash,0,e.Hash.length):t.bytes===Array?Array.prototype.slice.call(e.Hash):e.Hash),e.Name!=null&&e.hasOwnProperty("Name")&&(a.Name=e.Name),e.Tsize!=null&&e.hasOwnProperty("Tsize")&&(typeof e.Tsize=="number"?a.Tsize=t.longs===String?String(e.Tsize):e.Tsize:a.Tsize=t.longs===String?n.Long.prototype.toString.call(e.Tsize):t.longs===Number?new n.LongBits(e.Tsize.low>>>0,e.Tsize.high>>>0).toNumber(!0):e.Tsize),a},i.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},i}(),r.PBNode=function(){function i(s){if(this.Links=[],s)for(var e=Object.keys(s),t=0;t<e.length;++t)s[e[t]]!=null&&(this[e[t]]=s[e[t]])}return i.prototype.Links=n.emptyArray,i.prototype.Data=n.newBuffer([]),i.encode=function(e,t){if(t||(t=u.create()),e.Data!=null&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(10).bytes(e.Data),e.Links!=null&&e.Links.length)for(var a=0;a<e.Links.length;++a)r.PBLink.encode(e.Links[a],t.uint32(18).fork()).ldelim();return t},i.decode=function(e,t){e instanceof o||(e=o.create(e));for(var a=t===void 0?e.len:e.pos+t,l=new r.PBNode;e.pos<a;){var f=e.uint32();switch(f>>>3){case 2:l.Links&&l.Links.length||(l.Links=[]),l.Links.push(r.PBLink.decode(e,e.uint32()));break;case 1:l.Data=e.bytes();break;default:e.skipType(f&7);break}}return l},i.fromObject=function(e){if(e instanceof r.PBNode)return e;var t=new r.PBNode;if(e.Links){if(!Array.isArray(e.Links))throw TypeError(".PBNode.Links: array expected");t.Links=[];for(var a=0;a<e.Links.length;++a){if(typeof e.Links[a]!="object")throw TypeError(".PBNode.Links: object expected");t.Links[a]=r.PBLink.fromObject(e.Links[a])}}return e.Data!=null&&(typeof e.Data=="string"?n.base64.decode(e.Data,t.Data=n.newBuffer(n.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),t},i.toObject=function(e,t){t||(t={});var a={};if((t.arrays||t.defaults)&&(a.Links=[]),t.defaults&&(t.bytes===String?a.Data="":(a.Data=[],t.bytes!==Array&&(a.Data=n.newBuffer(a.Data)))),e.Data!=null&&e.hasOwnProperty("Data")&&(a.Data=t.bytes===String?n.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),e.Links&&e.Links.length){a.Links=[];for(var l=0;l<e.Links.length;++l)a.Links[l]=r.PBLink.toObject(e.Links[l],t)}return a},i.prototype.toJSON=function(){return this.constructor.toObject(this,c.util.toJSONOptions)},i}(),D=r,D}var z,$;function re(){if($)return z;$=1;const{bases:c}=fe;function o(i,s,e,t){return{name:i,prefix:s,encoder:{name:i,prefix:s,encode:e},decoder:{decode:t}}}const u=o("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),n=o("ascii","a",i=>{let s="a";for(let e=0;e<i.length;e++)s+=String.fromCharCode(i[e]);return s},i=>{i=i.substring(1);const s=new Uint8Array(i.length);for(let e=0;e<i.length;e++)s[e]=i.charCodeAt(e);return s});return z={utf8:u,"utf-8":u,hex:c.base16,latin1:n,ascii:n,binary:n,...c},z}var m,R;function ne(){if(R)return m;R=1;const c=re();function o(u,n="utf8"){const r=c[n];if(!r)throw new Error(`Unsupported encoding "${n}"`);return r.decoder.decode(`${r.prefix}${u}`)}return m=o,m}var p,C;function g(){if(C)return p;C=1;const c=b(),o=ne();class u{constructor(r,i,s){if(!s)throw new Error("A link requires a cid to point to");this.Name=r||"",this.Tsize=i,this.Hash=new c(s),Object.defineProperties(this,{_nameBuf:{value:null,writable:!0,enumerable:!1}})}toString(){return`DAGLink <${this.Hash.toBaseEncodedString()} - name: "${this.Name}", size: ${this.Tsize}>`}toJSON(){return this._json||(this._json=Object.freeze({name:this.Name,size:this.Tsize,cid:this.Hash.toBaseEncodedString()})),Object.assign({},this._json)}get nameAsBuffer(){return this._nameBuf!=null?this._nameBuf:(this._nameBuf=o(this.Name),this._nameBuf)}}return p=u,p}var A,E;function Le(){if(E)return A;E=1;function c(o,u){for(let n=0;n<o.byteLength;n++){if(o[n]<u[n])return-1;if(o[n]>u[n])return 1}return o.byteLength>u.byteLength?1:o.byteLength<u.byteLength?-1:0}return A=c,A}var v,U;function ie(){if(U)return v;U=1;const c=le(),o=Le(),u=(r,i)=>{const s=r.nameAsBuffer,e=i.nameAsBuffer;return o(s,e)};return v=r=>{c.inplace(r,u)},v}var N,J;function se(){if(J)return N;J=1;const c=g();function o(u){return new c(u.Name||u.name||"",u.Tsize||u.Size||u.size||0,u.Hash||u.hash||u.multihash||u.cid)}return N={createDagLinkFromB58EncodedHash:o},N}var w,F;function ae(){if(F)return w;F=1;const c=ee(),{PBLink:o}=te(),{createDagLinkFromB58EncodedHash:u}=se(),n=e=>{const t={};return e.Data&&e.Data.byteLength>0?t.Data=e.Data:t.Data=null,e.Links&&e.Links.length>0?t.Links=e.Links.map(a=>({Hash:a.Hash.bytes,Name:a.Name,Tsize:a.Tsize})):t.Links=null,t};w={serializeDAGNode:e=>s(n(e)),serializeDAGNodeLike:(e,t=[])=>{const a={Data:e,Links:t.map(l=>u(l))};return s(n(a))}};function s(e){const t=c.Writer.create();if(e.Links!=null)for(let a=0;a<e.Links.length;a++)o.encode(e.Links[a],t.uint32(18).fork()).ldelim();return e.Data!=null&&t.uint32(10).bytes(e.Data),t.finish()}return w}var S,I;function oe(){if(I)return S;I=1;const c=b(),o=he(),u=de,{multihash:n}=u,r=o.DAG_PB,i=n.names["sha2-256"];return S={codec:r,defaultHashAlg:i,cid:async(e,t={})=>{const a={cidVersion:t.cidVersion==null?1:t.cidVersion,hashAlg:t.hashAlg==null?i:t.hashAlg},l=n.codes[a.hashAlg],f=await u(e,l),d=o.getNameFromCode(r);return new c(a.cidVersion,d,f)}},S}var T,x;function ge(){if(x)return T;x=1;const c=g(),o=oe();return T=async(n,r={})=>{const i=n.serialize(),s=await o.cid(i,r);return new c(r.name||"",n.size,s)},T}var q,V;function ke(){if(V)return q;V=1;const c=ie(),o=g(),u=r=>{if(r instanceof o)return r;if(!("cid"in r||"hash"in r||"Hash"in r||"multihash"in r))throw new Error("Link must be a DAGLink or DAGLink-like. Convert the DAGNode into a DAGLink via `node.toDAGLink()`.");return new o(r.Name||r.name,r.Tsize||r.size,r.Hash||r.multihash||r.hash||r.cid)};return q=(r,i)=>{const s=u(i);r.Links.push(s),c(r.Links)},q}var B,W;function be(){if(W)return B;W=1;function c(o,u){if(o===u)return!0;if(o.byteLength!==u.byteLength)return!1;for(let n=0;n<o.byteLength;n++)if(o[n]!==u[n])return!1;return!0}return B=c,B}var H,M;function ye(){if(M)return H;M=1;const c=b(),o=be();return H=(n,r)=>{let i=null;if(typeof r=="string"?i=s=>s.Name===r:r instanceof Uint8Array?i=s=>o(s.Hash.bytes,r):c.isCID(r)&&(i=s=>o(s.Hash.bytes,r.bytes)),i){const s=n.Links;let e=0;for(;e<s.length;){const t=s[e];i(t)?s.splice(e,1):e++}}else throw new Error("second arg needs to be a name or CID")},H}var O,K;function De(){if(K)return O;K=1;const c=re();function o(u,n="utf8"){const r=c[n];if(!r)throw new Error(`Unsupported encoding "${n}"`);return r.encoder.encode(u).substring(1)}return O=o,O}var j,Q;function ue(){if(Q)return j;Q=1;const c=ie(),o=g(),{createDagLinkFromB58EncodedHash:u}=se(),{serializeDAGNode:n}=ae(),r=ge(),i=ke(),s=ye(),e=ne(),t=De();class a{constructor(f,d=[],h=null){if(f||(f=new Uint8Array(0)),typeof f=="string"&&(f=e(f)),!(f instanceof Uint8Array))throw new Error("Passed 'data' is not a Uint8Array or a String!");if(h!==null&&typeof h!="number")throw new Error("Passed 'serializedSize' must be a number!");const L=d.map(y=>y instanceof o?y:u(y));c(L),this.Data=f,this.Links=L,Object.defineProperties(this,{_serializedSize:{value:h,writable:!0,enumerable:!1},_size:{value:null,writable:!0,enumerable:!1}})}toJSON(){return this._json||(this._json=Object.freeze({data:this.Data,links:this.Links.map(f=>f.toJSON()),size:this.size})),Object.assign({},this._json)}toString(){return`DAGNode <data: "${t(this.Data,"base64urlpad")}", links: ${this.Links.length}, size: ${this.size}>`}_invalidateCached(){this._serializedSize=null,this._size=null}addLink(f){return this._invalidateCached(),i(this,f)}rmLink(f){return this._invalidateCached(),s(this,f)}toDAGLink(f){return r(this,f)}serialize(){const f=n(this);return this._serializedSize=f.length,f}get size(){if(this._size==null){let f;f==null&&(this._serializedSize=this.serialize().length,f=this._serializedSize),this._size=this.Links.reduce((d,h)=>d+h.Tsize,f)}return this._size}set size(f){throw new Error("Can't set property: 'size' is immutable")}}return j=a,j}var P,X;function ce(){if(X)return P;X=1;const{PBNode:c}=te(),o=g(),u=ue(),{serializeDAGNode:n,serializeDAGNodeLike:r}=ae(),i=oe(),s=(a,l)=>i.cid(a,l),e=a=>a instanceof u?n(a):r(a.Data,a.Links),t=a=>{const l=c.decode(a),f=c.toObject(l,{defaults:!1,arrays:!0,longs:Number,objects:!1}),d=f.Links.map(L=>new o(L.Name,L.Tsize,L.Hash)),h=f.Data==null?new Uint8Array(0):f.Data;return new u(h,d,a.byteLength)};return P={codec:i.codec,defaultHashAlg:i.defaultHashAlg,serialize:e,deserialize:t,cid:s},P}var Y;function ze(){if(Y)return k;Y=1;const c=b(),o=ce();return k.resolve=(u,n="/")=>{let r=o.deserialize(u);const i=n.split("/").filter(Boolean);for(;i.length;){const s=i.shift();if(r[s]===void 0){for(const e of r.Links)if(e.Name===s)return{value:e.Hash,remainderPath:i.join("/")};throw new Error(`Object has no property '${s}'`)}if(r=r[s],c.isCID(r))return{value:r,remainderPath:i.join("/")}}return{value:r,remainderPath:""}},k.tree=function*(u){const n=o.deserialize(u);yield"Data",yield"Links";for(let r=0;r<n.Links.length;r++)yield`Links/${r}`,yield`Links/${r}/Name`,yield`Links/${r}/Tsize`,yield`Links/${r}/Hash`},k}var G,Z;function Se(){if(Z)return G;Z=1;const c=ze(),o=ce(),u=ue(),n=g();return G={DAGNode:u,DAGLink:n,resolver:c,util:o,codec:o.codec,defaultHashAlg:o.defaultHashAlg},G}export{Se as r};
