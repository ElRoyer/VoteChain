import{r as k}from"./protobufjs.15525302.js";import{r as O}from"./err-code.3bb72d65.js";var g,T;function w(){if(T)return g;T=1;var f=k(),u=f.Reader,p=f.Writer,i=f.util,c=f.roots["ipfs-unixfs"]||(f.roots["ipfs-unixfs"]={});return c.Data=function(){function r(o){if(this.blocksizes=[],o)for(var e=Object.keys(o),t=0;t<e.length;++t)o[e[t]]!=null&&(this[e[t]]=o[e[t]])}return r.prototype.Type=0,r.prototype.Data=i.newBuffer([]),r.prototype.filesize=i.Long?i.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=i.emptyArray,r.prototype.hashType=i.Long?i.Long.fromBits(0,0,!0):0,r.prototype.fanout=i.Long?i.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(e,t){if(t||(t=p.create()),t.uint32(8).int32(e.Type),e.Data!=null&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),e.filesize!=null&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),e.blocksizes!=null&&e.blocksizes.length)for(var n=0;n<e.blocksizes.length;++n)t.uint32(32).uint64(e.blocksizes[n]);return e.hashType!=null&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),e.fanout!=null&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),e.mode!=null&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),e.mtime!=null&&Object.hasOwnProperty.call(e,"mtime")&&c.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},r.decode=function(e,t){e instanceof u||(e=u.create(e));for(var n=t===void 0?e.len:e.pos+t,s=new c.Data;e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:s.Type=e.int32();break;case 2:s.Data=e.bytes();break;case 3:s.filesize=e.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(a&7)===2)for(var l=e.uint32()+e.pos;e.pos<l;)s.blocksizes.push(e.uint64());else s.blocksizes.push(e.uint64());break;case 5:s.hashType=e.uint64();break;case 6:s.fanout=e.uint64();break;case 7:s.mode=e.uint32();break;case 8:s.mtime=c.UnixTime.decode(e,e.uint32());break;default:e.skipType(a&7);break}}if(!s.hasOwnProperty("Type"))throw i.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(e){if(e instanceof c.Data)return e;var t=new c.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5;break}if(e.Data!=null&&(typeof e.Data=="string"?i.base64.decode(e.Data,t.Data=i.newBuffer(i.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),e.filesize!=null&&(i.Long?(t.filesize=i.Long.fromValue(e.filesize)).unsigned=!0:typeof e.filesize=="string"?t.filesize=parseInt(e.filesize,10):typeof e.filesize=="number"?t.filesize=e.filesize:typeof e.filesize=="object"&&(t.filesize=new i.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var n=0;n<e.blocksizes.length;++n)i.Long?(t.blocksizes[n]=i.Long.fromValue(e.blocksizes[n])).unsigned=!0:typeof e.blocksizes[n]=="string"?t.blocksizes[n]=parseInt(e.blocksizes[n],10):typeof e.blocksizes[n]=="number"?t.blocksizes[n]=e.blocksizes[n]:typeof e.blocksizes[n]=="object"&&(t.blocksizes[n]=new i.LongBits(e.blocksizes[n].low>>>0,e.blocksizes[n].high>>>0).toNumber(!0))}if(e.hashType!=null&&(i.Long?(t.hashType=i.Long.fromValue(e.hashType)).unsigned=!0:typeof e.hashType=="string"?t.hashType=parseInt(e.hashType,10):typeof e.hashType=="number"?t.hashType=e.hashType:typeof e.hashType=="object"&&(t.hashType=new i.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),e.fanout!=null&&(i.Long?(t.fanout=i.Long.fromValue(e.fanout)).unsigned=!0:typeof e.fanout=="string"?t.fanout=parseInt(e.fanout,10):typeof e.fanout=="number"?t.fanout=e.fanout:typeof e.fanout=="object"&&(t.fanout=new i.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),e.mode!=null&&(t.mode=e.mode>>>0),e.mtime!=null){if(typeof e.mtime!="object")throw TypeError(".Data.mtime: object expected");t.mtime=c.UnixTime.fromObject(e.mtime)}return t},r.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.blocksizes=[]),t.defaults){if(n.Type=t.enums===String?"Raw":0,t.bytes===String?n.Data="":(n.Data=[],t.bytes!==Array&&(n.Data=i.newBuffer(n.Data))),i.Long){var s=new i.Long(0,0,!0);n.filesize=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.filesize=t.longs===String?"0":0;if(i.Long){var s=new i.Long(0,0,!0);n.hashType=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.hashType=t.longs===String?"0":0;if(i.Long){var s=new i.Long(0,0,!0);n.fanout=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.fanout=t.longs===String?"0":0;n.mode=0,n.mtime=null}if(e.Type!=null&&e.hasOwnProperty("Type")&&(n.Type=t.enums===String?c.Data.DataType[e.Type]:e.Type),e.Data!=null&&e.hasOwnProperty("Data")&&(n.Data=t.bytes===String?i.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),e.filesize!=null&&e.hasOwnProperty("filesize")&&(typeof e.filesize=="number"?n.filesize=t.longs===String?String(e.filesize):e.filesize:n.filesize=t.longs===String?i.Long.prototype.toString.call(e.filesize):t.longs===Number?new i.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){n.blocksizes=[];for(var a=0;a<e.blocksizes.length;++a)typeof e.blocksizes[a]=="number"?n.blocksizes[a]=t.longs===String?String(e.blocksizes[a]):e.blocksizes[a]:n.blocksizes[a]=t.longs===String?i.Long.prototype.toString.call(e.blocksizes[a]):t.longs===Number?new i.LongBits(e.blocksizes[a].low>>>0,e.blocksizes[a].high>>>0).toNumber(!0):e.blocksizes[a]}return e.hashType!=null&&e.hasOwnProperty("hashType")&&(typeof e.hashType=="number"?n.hashType=t.longs===String?String(e.hashType):e.hashType:n.hashType=t.longs===String?i.Long.prototype.toString.call(e.hashType):t.longs===Number?new i.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),e.fanout!=null&&e.hasOwnProperty("fanout")&&(typeof e.fanout=="number"?n.fanout=t.longs===String?String(e.fanout):e.fanout:n.fanout=t.longs===String?i.Long.prototype.toString.call(e.fanout):t.longs===Number?new i.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),e.mode!=null&&e.hasOwnProperty("mode")&&(n.mode=e.mode),e.mtime!=null&&e.hasOwnProperty("mtime")&&(n.mtime=c.UnixTime.toObject(e.mtime,t)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,f.util.toJSONOptions)},r.DataType=function(){var o={},e=Object.create(o);return e[o[0]="Raw"]=0,e[o[1]="Directory"]=1,e[o[2]="File"]=2,e[o[3]="Metadata"]=3,e[o[4]="Symlink"]=4,e[o[5]="HAMTShard"]=5,e}(),r}(),c.UnixTime=function(){function r(o){if(o)for(var e=Object.keys(o),t=0;t<e.length;++t)o[e[t]]!=null&&(this[e[t]]=o[e[t]])}return r.prototype.Seconds=i.Long?i.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(e,t){return t||(t=p.create()),t.uint32(8).int64(e.Seconds),e.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},r.decode=function(e,t){e instanceof u||(e=u.create(e));for(var n=t===void 0?e.len:e.pos+t,s=new c.UnixTime;e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:s.Seconds=e.int64();break;case 2:s.FractionalNanoseconds=e.fixed32();break;default:e.skipType(a&7);break}}if(!s.hasOwnProperty("Seconds"))throw i.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(e){if(e instanceof c.UnixTime)return e;var t=new c.UnixTime;return e.Seconds!=null&&(i.Long?(t.Seconds=i.Long.fromValue(e.Seconds)).unsigned=!1:typeof e.Seconds=="string"?t.Seconds=parseInt(e.Seconds,10):typeof e.Seconds=="number"?t.Seconds=e.Seconds:typeof e.Seconds=="object"&&(t.Seconds=new i.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),e.FractionalNanoseconds!=null&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},r.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(i.Long){var s=new i.Long(0,0,!1);n.Seconds=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.Seconds=t.longs===String?"0":0;n.FractionalNanoseconds=0}return e.Seconds!=null&&e.hasOwnProperty("Seconds")&&(typeof e.Seconds=="number"?n.Seconds=t.longs===String?String(e.Seconds):e.Seconds:n.Seconds=t.longs===String?i.Long.prototype.toString.call(e.Seconds):t.longs===Number?new i.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),e.FractionalNanoseconds!=null&&e.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=e.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,f.util.toJSONOptions)},r}(),c.Metadata=function(){function r(o){if(o)for(var e=Object.keys(o),t=0;t<e.length;++t)o[e[t]]!=null&&(this[e[t]]=o[e[t]])}return r.prototype.MimeType="",r.encode=function(e,t){return t||(t=p.create()),e.MimeType!=null&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},r.decode=function(e,t){e instanceof u||(e=u.create(e));for(var n=t===void 0?e.len:e.pos+t,s=new c.Metadata;e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:s.MimeType=e.string();break;default:e.skipType(a&7);break}}return s},r.fromObject=function(e){if(e instanceof c.Metadata)return e;var t=new c.Metadata;return e.MimeType!=null&&(t.MimeType=String(e.MimeType)),t},r.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.MimeType=""),e.MimeType!=null&&e.hasOwnProperty("MimeType")&&(n.MimeType=e.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,f.util.toJSONOptions)},r}(),g=c,g}var d,m;function L(){if(m)return d;m=1;const{Data:f}=w(),u=O(),p=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],i=["directory","hamt-sharded-directory"],c=parseInt("0644",8),r=parseInt("0755",8);function o(n){if(n!=null)return typeof n=="number"?n&4095:(n=n.toString(),n.substring(0,1)==="0"?parseInt(n,8)&4095:parseInt(n,10)&4095)}function e(n){if(n==null)return;let s;if(n.secs!=null&&(s={secs:n.secs,nsecs:n.nsecs}),n.Seconds!=null&&(s={secs:n.Seconds,nsecs:n.FractionalNanoseconds}),Array.isArray(n)&&(s={secs:n[0],nsecs:n[1]}),n instanceof Date){const a=n.getTime(),l=Math.floor(a/1e3);s={secs:l,nsecs:(a-l*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(s,"secs")){if(s!=null&&s.nsecs!=null&&(s.nsecs<0||s.nsecs>999999999))throw u(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return s}}class t{static unmarshal(s){const a=f.decode(s),l=f.toObject(a,{defaults:!1,arrays:!0,longs:Number,objects:!1}),h=new t({type:p[l.Type],data:l.Data,blockSizes:l.blocksizes,mode:l.mode,mtime:l.mtime?{secs:l.mtime.Seconds,nsecs:l.mtime.FractionalNanoseconds}:void 0});return h._originalMode=l.mode||0,h}constructor(s={type:"file"}){const{type:a,data:l,blockSizes:h,hashType:b,fanout:y,mtime:S,mode:z}=s;if(a&&!p.includes(a))throw u(new Error("Type: "+a+" is not valid"),"ERR_INVALID_TYPE");this.type=a||"file",this.data=l,this.hashType=b,this.fanout=y,this.blockSizes=h||[],this._originalMode=0,this.mode=o(z),S&&(this.mtime=e(S),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(s){this._mode=this.isDirectory()?r:c;const a=o(s);a!==void 0&&(this._mode=a)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&i.includes(this.type))}addBlockSize(s){this.blockSizes.push(s)}removeBlockSize(s){this.blockSizes.splice(s,1)}fileSize(){if(this.isDirectory())return 0;let s=0;return this.blockSizes.forEach(a=>{s+=a}),this.data&&(s+=this.data.length),s}marshal(){let s;switch(this.type){case"raw":s=f.DataType.Raw;break;case"directory":s=f.DataType.Directory;break;case"file":s=f.DataType.File;break;case"metadata":s=f.DataType.Metadata;break;case"symlink":s=f.DataType.Symlink;break;case"hamt-sharded-directory":s=f.DataType.HAMTShard;break;default:throw u(new Error("Type: "+s+" is not valid"),"ERR_INVALID_TYPE")}let a=this.data;(!this.data||!this.data.length)&&(a=void 0);let l;this.mode!=null&&(l=this._originalMode&4294963200|(o(this.mode)||0),l===c&&!this.isDirectory()&&(l=void 0),l===r&&this.isDirectory()&&(l=void 0));let h;if(this.mtime!=null){const y=e(this.mtime);y&&(h={Seconds:y.secs,FractionalNanoseconds:y.nsecs},h.FractionalNanoseconds===0&&delete h.FractionalNanoseconds)}const b={Type:s,Data:a,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:l,mtime:h};return f.encode(b).finish()}}return d={UnixFS:t,parseMode:o,parseMtime:e},d}export{L as r};
